# Define variables
$taskName = "StartSProgram"
$actionPath = "C:\Users\User\Desktop\s.exe"

# Check if the task exists
$existingTask = Get-ScheduledTask -TaskName $taskName -ErrorAction SilentlyContinue

if ($existingTask -eq $null) {
    # Task does not exist, create new task
    $trigger = New-ScheduledTaskTrigger -AtStartup
    $action = New-ScheduledTaskAction -Execute $actionPath
    Register-ScheduledTask -TaskName $taskName -Trigger $trigger -Action $action -User "NT AUTHORITY\SYSTEM" -RunLevel Highest -Force
    Write-Host "Task '$taskName' created successfully."
} else {
    Write-Host "Task '$taskName' already exists."
}
